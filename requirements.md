# tldvメール処理システム要件定義書

## 概要
Gmailに届く「tldv」ラベル付きメールを自動的にスプレッドシートに転記し、処理済みとして管理するGoogle Apps Script (GAS) システム。

## 機能要件

### 1. メール処理機能
- **対象メール**: 「tldv」ラベルが付いたメール全て
- **取得情報**:
  - 受信日時
  - 件名
  - 本文
- **処理内容**:
  1. 対象メールの情報を取得
  2. スプレッドシートのA列から順に転記（A列:受信日時、B列:件名、C列:本文）
  3. 処理完了後、「tldv」ラベルを削除
  4. 「処理済み」ラベルを付与

### 2. 自動実行機能
- **実行頻度**: 1時間に1回
- **実装方法**: GASトリガーを使用

### 3. 手動実行機能
- **メニューバー項目**:
  - 手動実行ボタン
  - トリガー設定ボタン
  - メールアドレス設定ボタン
- **実装方法**: onOpen関数を使用してカスタムメニューを作成

### 4. 設定管理機能
- **対象メールアドレス**: スクリプトプロパティで管理
- **UI設定**: メニューバーから設定可能なダイアログを提供

## 技術仕様
- **実行環境**: Google Apps Script V8ランタイム
- **必要なサービス**:
  - GmailApp
  - SpreadsheetApp
  - PropertiesService
  - ScriptApp（トリガー管理）

## ファイル構成
```
コード.gs
├── onOpen()              // メニューバー初期化
├── processEmails()       // メイン処理関数
├── setEmailAddress()     // メールアドレス設定UI
├── setupTrigger()        // トリガー設定
└── removeTriggers()      // トリガー削除
```

## エラーハンドリング
- メール取得エラー時の処理
- スプレッドシート書き込みエラー時の処理
- ラベル操作エラー時の処理

## セキュリティ考慮事項
- スクリプトプロパティによる設定値の保護
- 実行権限の適切な管理