# 📝 tldvの議事録を自動でDiscordに投稿する仕組みを作ってみた

## 🎯 はじめに

こんにちは！keitaroです。

最近、オンライン会議が増えてきて、議事録の管理が大変になってきませんか？

私も同じ悩みを抱えていて、特に**tldv**で録画した会議の議事録をチームに共有するのが面倒でした。

そこで今回、**会議が終わったら自動的にDiscordに議事録を投稿してくれる仕組み**を作ってみました！

## 🤔 なぜ作ったのか

### 課題
- 会議終了後、毎回手動で議事録を共有するのが面倒
- tldvのメール通知を見逃すことがある
- チームメンバーが議事録にアクセスしづらい

### 解決策
**Google Apps Script（GAS）を使って全自動化！**

## ✨ できること

この仕組みを使うと、こんなことが自動でできます：

1. **📹 会議を録画** → tldvで普通に録画するだけ
2. **📧 メール受信** → 録画が終わるとtldvから議事録メールが届く
3. **🏷️ 自動ラベル付け** → Gmailが「tldv」ラベルを自動で付ける
4. **🤖 自動処理** → 毎時GASが起動（手動実行もOK）
5. **🔀 キーワード分岐** → 設定されたキーワードに基づいて自動的に専用シートに分類
6. **📊 スプレッドシート記録** → 日時・件名・概要を自動でスプレッドシートに記録
7. **💬 Discord通知** → メインシートと分岐シートの両方に対応した自動Discord通知
8. **📝 通知ログ** → 送信状況を追跡できる詳細なログ機能

## 🛠️ 作り方

### 必要なもの
- Googleアカウント
- tldvアカウント
- Discordサーバー（管理権限が必要）

### ステップ1：Gmailの設定

まず、tldvからのメールを自動で仕分けします。

```
1. Gmailを開く
2. 設定 → フィルタとブロック中のアドレス
3. 新しいフィルタを作成
4. From: tldv関連のメールアドレス
5. ラベル「tldv」を付ける
```

### ステップ2：Discord Webhookの準備

Discordに投稿するための「Webhook」を作ります。

```
1. Discordサーバーの設定を開く
2. 連携サービス → ウェブフック
3. 新しいウェブフックを作成
4. 名前を「議事録Bot」などに設定
5. URLをコピー（後で使います）
```

### ステップ3：スプレッドシートとGASの設定

ここからが本番です！

#### 基本設定
1. **Google スプレッドシート**を新規作成
2. **スクリプトエディタ**を開く（拡張機能 → Apps Script）
3. **コード.gs**ファイルにメイン処理を記述

#### 主要機能

```javascript
// メール処理（基本機能）
function processEmails() {
  // Gmailから「tldv」ラベルの付いたメールを取得
  const tldvLabel = GmailApp.getUserLabelByName('tldv');
  const threads = tldvLabel.getThreads();
  
  threads.forEach(thread => {
    // メール内容を解析してスプレッドシートに記録
    // 処理済みラベルに移動
  });
}

// キーワード分岐機能
function processKeywordBranching() {
  // 設定シートのキーワードを基に分岐処理
  // 条件に合う議事録を専用シートに振り分け
}

// Discord通知機能
function sendUnsentToDiscord() {
  // メインシートの未送信項目をDiscordに通知
}

function sendBranchDiscordNotifications() {
  // 各分岐シートの未送信項目を個別のDiscordチャンネルに通知
}
```

#### 設定シートの構造
| A列 | B列（キーワード） | C列（WebhookURL） | D列 | E列（シート名） |
|-----|------------------|-------------------|-----|----------------|
| 1   | 営業             | https://discord... |     | 営業会議       |
| 2   | 開発             | https://discord... |     | 開発ミーティング |

### ステップ4：自動実行の設定

毎時自動実行するトリガーを設定します。

```
1. GASエディタで「トリガー」をクリック
2. 「トリガーを追加」
3. 実行する関数：processEmails
4. 時間ベースのトリガー：時間ベース
5. 実行間隔：1時間おき
```

### ステップ5：メニューとマニュアル操作

スプレッドシートから手動実行できるメニューが自動で追加されます：

- **📧 メール処理** - tldvメールを処理してスプレッドシートに記録
- **🔀 キーワード分岐** - キーワードに基づいて分岐シートに振り分け
- **📤 Discord通知** - メインシートからDiscord通知
- **📢 分岐Discord通知** - 各分岐シートからDiscord通知
- **⚙️ 設定** - 各種設定（メールアドレス、WebhookURL等）
- **📐 分岐シート書式設定** - 分岐シートの書式を統一

## 💡 使ってみた感想

### よかったこと
- 📌 議事録の共有忘れがなくなった
- ⏰ 作業時間が大幅に削減（1回5分 → 0分）
- 👥 チーム全員がすぐに議事録を確認できる
- 🔀 キーワード分岐で部署別・プロジェクト別に自動分類
- 📊 スプレッドシートで履歴管理と分析が簡単
- 🔄 複数チャンネルへの自動通知で情報共有が効率化

### 改善したいこと
- AI要約機能の追加でより簡潔な要約を作成
- 参加者のメンション機能
- 重要度に応じたDiscord通知の優先度設定

## 📊 実際の動作フロー

実際のシステムは以下の流れで動作します：

### 基本フロー
1. **📹 会議録画** - tldvで会議を録画
2. **📧 メール受信** - Gmailに議事録メールが届く
3. **🏷️ ラベル付与** - 「tldv」ラベルが自動で付く
4. **⏰ 自動処理** - 毎時トリガーでメール処理が実行
5. **📊 スプレッドシート記録** - 日時・件名・内容を記録
6. **🔀 キーワード分岐** - 設定されたキーワードで分岐シートに振り分け
7. **💬 Discord通知** - メインシートと分岐シートそれぞれに通知

### 分岐処理の例
- 「営業」キーワード含む → 営業会議シートに移動 + 営業チームDiscordに通知
- 「開発」キーワード含む → 開発ミーティングシートに移動 + 開発チームDiscordに通知
- キーワード未一致 → メインシートに残存 + デフォルトDiscordに通知

## 🎉 まとめ

この仕組みを作ってから、議事録の管理がめちゃくちゃ楽になりました！

特に良いのは、**一度設定すれば完全自動**なところ。もう議事録の共有を忘れることはありません。

みなさんも、日々の面倒な作業があったら、GASで自動化してみてはいかがでしょうか？

## 🚀 今後の展開

- [ ] AI要約機能の追加（GPT-4を使って）
- [ ] 参加者ごとの発言分析
- [ ] アクションアイテムの自動抽出
- [ ] Slack連携機能
- [ ] カスタムフィルタ機能の拡張
- [ ] 議事録の重要度自動判定

## 📝 技術的な補足

### 使用技術
- **Google Apps Script（JavaScript）** - メイン処理エンジン
- **Gmail API** - メール自動処理
- **Discord Webhook API** - 通知システム
- **Google Spreadsheet API** - データ管理・分析
- **PropertiesService** - 設定管理
- **正規表現** - キーワードマッチング

### 処理性能
- **メール処理**: 1件あたり約3秒
- **分岐処理**: キーワード数に依存（通常1-2秒）
- **Discord通知**: 1件あたり約1秒
- **同時処理**: 最大10件まで

### セキュリティ
- **WebhookURL**: スクリプトプロパティで暗号化保存
- **メール処理**: ラベルベースでの安全な処理
- **ログ機能**: 送信状況の完全追跡

## 🙏 さいごに

この記事が、同じような悩みを持つ方の参考になれば嬉しいです！

質問やアドバイスがあれば、ぜひコメントで教えてください。

GitHubにもコードを公開予定なので、★をもらえると励みになります！

---
📅 最終更新日: 2025/07/14

## 🔧 Version History

### v2.0.0 (2025/07/14)
- ✅ キーワードベース分岐機能追加
- ✅ 複数Discord通知システム実装
- ✅ 送信ログ機能追加
- ✅ 自動書式設定機能
- ✅ メニュー構造の最適化

### v1.0.0 (2025/07/13)
- ✅ 基本的なメール処理機能
- ✅ Discord通知機能
- ✅ スプレッドシート連携

---

#tldv #Discord #GAS #自動化 #議事録 #業務効率化 #キーワード分岐 #通知システム